<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cms.java_competition_management_system.mapper.UserMapper">
    <resultMap id="UserResultMap" type="cms.java_competition_management_system.entity.User">
        <id column="user_id" property="userId"/>
        <result column="user_name" property="userName"/>
        <result column="nick_name" property="nickName"/>
        <result column="stu_id" property="stuId"/>
        <result column="password" property="password"/>
        <result column="avatar" property="avatar"/>
        <result column="age" property="age"/>
        <result column="sex" property="sex"/>
        <result column="birthday" property="birthday"/>
        <result column="email" property="email"/>
        <result column="classes" property="classes"/>
        <result column="hobby" property="hobby"/>
        <result column="address" property="address"/>
        <result column="college" property="college"/>
        <result column="profession" property="profession"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
        <result column="creator" property="creator"/>
        <result column="deleted" property="deleted"/>
        <collection property="roleSet" resultMap="RoleResultMap"/>
    </resultMap>
    <resultMap id="RoleResultMap" type="cms.java_competition_management_system.entity.Role">
        <id column="role_id" property="roleId"/>
        <result column="role_label" property="roleLabel"/>
        <result column="role_name" property="roleName"/>
        <result column="status" property="status"/>
        <result column="deleted" property="deleted"/>
        <result column="create_Time" property="createTime"/>
    </resultMap>
    <select id="selectByStuId" resultMap="UserResultMap">
        select
            u.user_id,u.user_name,u.nick_name,u.stu_id,u.password,u.avatar,u.age,u.sex,u.birthday,u.email,
            u.classes,u.hobby,u.address,u.college,u.profession,u.status,u.create_time,u.creator,u.deleted,
            r.role_id,r.role_label,r.role_name,r.status,r.deleted,r.create_Time
        from user u left join user_role ur on u.user_id = ur.user_id
                    left join role r on ur.role_id = r.role_id
        where u.deleted = 0 and r.deleted = 0 and u.stu_id = #{stuId}
    </select>
</mapper>
